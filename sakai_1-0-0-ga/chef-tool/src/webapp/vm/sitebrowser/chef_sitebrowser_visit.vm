##<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/sitebrowser/chef_sitebrowser_visit.vm,v 1.3 2004/09/10 03:05:29 janderse.umich.edu Exp $ -->
##<script type="text/javascript" language="JavaScript">
## focus_path = [#if(!$site)"id"#else"title"#end];
##</script>
<div class="chefPortletContainer">
#if($menu)
	#toolbar($menu)
#end
	<div class ="chefPortletContent">
		#if($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
		<div style="font-size:120%;font-weight:bold">$validator.escapeHtml($site.Title)</div>
		#if ($infoUrl)
					<iframe style="display:block;clear:both" 
						width="100%"
						#if ($height) height="$height" #end
						frameborder="0"
						marginwidth="0"
						marginheight="0"
						scrolling="auto"
						align="middle"
						src="$infoUrl">
					</iframe>
		#end
		#set ($sdesc = $site.Description)
		#if ($sdesc && ($sdesc.length() > 0))
			<div style="margin-top:1em;margin-bottom:2em">$validator.escapeHtml($sdesc)</div>
		#end
		#if ($announcements.size() > 0)
			<div class="groupTitle" style ="margin-left:1em;font-weight:bold;margin-bottom:1em;margin-top:1em;border-bottom:1px solid #C0C0C0;padding-bottom:5px">Announcements</div>
			#foreach ($message in $announcements)
					<div class="itemTitle" style ="margin-left:2em;font-weight:bold;margin-bottom:.5em;margin-top:.5em">$validator.escapeHtml($message.Header.subject) - $validator.escapeHtml($message.Header.From.DisplayName) ($message.Header.Date.toStringLocalFull())</div>
					<div class="itemContent" style ="margin-left:3em">
						$validator.escapeHtmlFormattedText($message.body)
						#if (!$message.Header.Attachments.isEmpty())
							#set ($props = false)
							<ul class="chefAttachmentList">
								#foreach ($attachment in $message.Header.Attachments)
									#set ($props = $attachment.Properties)
									#if ($props)
										<li>
											#if ($props.getBooleanProperty($props.NamePropIsCollection))
												<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder" />
											#else
												<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="" />
											#end
												<a href="$attachment.Url" target="_blank">
													$validator.escapeHtml($attachment.Properties.getPropertyFormatted("DAV:displayname"))
												</a>
											#if (!$props.getBooleanProperty($props.NamePropIsCollection))
																	($props.getPropertyFormatted($props.NamePropContentLength))
											#end
										</li>
									#end
								#end
							</ul>	
						#end
					</div>	
			#end
		#end
		#if ($resources.size() > 0)
			<div class="groupTitle" style ="margin-left:1em;font-weight:bold;margin-bottom:1em;margin-top:1em;border-bottom:1px solid #C0C0C0;padding-bottom:5px">Resources</div>
			#foreach ($rsrc in $resources)
				#set ($properties = $rsrc.Properties)
				<div class="itemTitle" style ="margin-left:2em;font-weight:bold;margin-bottom:.5em;margin-top:.5em">
					<a href="$rsrc.Url" target="_blank">
						#if ($properties.getBooleanProperty($properties.NamePropIsCollection))
							<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt ="folder" />
						#else
							<img src = "#imageLink($contentTypeImageService.getContentTypeImage($properties.getProperty($properties.NamePropContentType)))" border="0" alt ="" />
						#end
							$validator.escapeHtml($properties.getPropertyFormatted($properties.NamePropDisplayName))
					</a>
				</div>
				<div class="itemContent" style ="margin-left:3em;margin-bottom:.5em">
					<div class="itemMetaData" style ="margin-top:.5em;margin-bottom:.5em;font-size:85%">
						$validator.escapeHtml($properties.getPropertyFormatted($properties.NamePropCreator))  ($properties.getPropertyFormatted($properties.NamePropCreationDate)).<br /> 
						Size:  $properties.getPropertyFormatted($properties.NamePropContentLength).  
					</div>
					#set ($desc = $properties.getPropertyFormatted($properties.NamePropDescription))
					#if ($desc && ($desc.length() > 0))
						<span class="chefPre">$validator.escapeHtml($desc)</span>
					#end
				</div>	
			#end
		#end
		<br />
		<a href="#" onclick="location='#toolLink($action "doBack")';return false;">Back</a>
	</div>
</div>
