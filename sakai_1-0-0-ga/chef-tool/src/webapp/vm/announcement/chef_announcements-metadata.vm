<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/announcement/chef_announcements-metadata.vm,v 1.2 2004/06/18 19:07:25 janderse Exp $ -->
<div class="chefPortletContainer">
	#if($menu && $EnabledMenuItemExists)
		#toolbar($menu)
	#end
	<div class = "chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
		<div style="display:block;clear:both"></div>
		<div class="chefPageViewTitle"> </div>
		<table cellspacing="0" class="chefItemDetail">
			<tr>
				<td class="chefLabel">Subject:</td>
				<td>$validator.escapeHtml($message.Header.subject)</td>
			</tr>
			<tr>
				<td class="chefLabel">From:</td>
				<td>$validator.escapeHtml($message.Header.From.DisplayName)</td>
			</tr>
			<tr>
				<td class="chefLabel">Date:</td>
				<td>$message.Header.Date.toStringLocalFull()</td>
			</tr>
                         <tr>
                                <td class="chefLabel">Public viewable:</td>
                                <td>#if ($pubview) Yes #else No #end</td>
                        </tr>
		</table>
		<div class="chefSectionTitle">Message:</div>
		<div class="chefSectionMessage"><span class="chefPre">$validator.escapeHtmlFormattedText($message.body)</span></div>
		<div class="chefSectionTitle">Attachments:</div>
		<div class="chefSectionMessage">
			#set ($size = 0)
			#if (!$message.Header.Attachments.isEmpty())
				#set ($props = false)
				#set ($size = $message.Header.Attachments.size())
##Note(gds): next node should not be rendered if there are no attachments. XHTML does not allow childless "<ul>"
				<ul class="chefAttachmentList">
					#foreach ($attachment in $message.Header.Attachments)
						#set ($props = $attachment.Properties)
						#if (!$props)
							#if ($size > 0) #set ($size = $size - 1) #end
						#else
							<li>
								#if ($props.getBooleanProperty($props.NamePropIsCollection))
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" />
								#else
									<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" />
								#end
								<a href="$attachment.Url" target="_blank">
									$validator.escapeHtml($attachment.Properties.getPropertyFormatted("DAV:displayname"))</a>
								#if (!$props.getBooleanProperty($props.NamePropIsCollection))
									($props.getPropertyFormatted($props.NamePropContentLength))
								#end
							</li>
						#end
					#end
				</ul>
			#end
			#if ($size == 0) No attachments ... #end
		</div>
		</br><a href="#" onclick="location='#toolLink("AnnouncementAction" "doLinkcancel")';return false;">Back</a>
	</div>
</div>
