## $Header: /cvs/sakai/chef-tool/src/webapp/vm/announcement/chef_announcements-preview.vm,v 1.2 2004/06/18 19:06:48 janderse Exp $
<div class="chefPortletContainer">
    <div class ="chefPortletToolBarMessage">
	    Previewing announcement...
	</div>
	<div class="chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
			<table cellspacing="0" class="chefItemDetail">
				<tr>
					<td class="chefLabel">Subject:</td>
					<td>$validator.escapeHtml($subject)</td>
				</tr>
				<tr> 
					<td class="chefLabel">From:</td>
					<td>$validator.escapeHtml($user.DisplayName)</td>
				</tr>
				<tr>
					<td class="chefLabel">Date:</td>
                                        <td>$date.toStringLocalFull()</td>
				</tr>
                                <tr>
					<td class="chefLabel">Public viewable:</td>
                                        <td>$IsPubView</td>
				</tr>
                                <tr>
					<td class="chefLabel">Notification:</td>
                                        <td>$noti</td>
				</tr>
			</table>
			<div class="chefSectionTitle">Message:</div>
			<div class="chefSectionMessage"><span class="chefPre">$validator.escapeHtmlFormattedText($body)</span></div>
			<div class="chefSectionTitle">Attachments:</div>
			<div class="chefSectionMessage">
				#set ($size = 0)
				#if (!$attachments.isEmpty())
						#set ($props = false)
						#set ($size =  $attachments.size())
## Note(gds): do not output next node if there are no attachments. XHTML does not allow childless <ul>
						<ul class="chefAttachmentList">
							#foreach ($attachment in $attachments)
								#set ($props = $attachment.Properties)
								#if (!$props)
									#if ($size > 0) #set ($size = $size - 1) #end
								#else
									#if ($props.getBooleanProperty($props.NamePropIsCollection))
									<li><img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" />
									#else
									<li><img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" />
									#end
									<a href="$attachment.Url" target="_blank">
									  $validator.escapeHtml($attachment.Properties.getPropertyFormatted("DAV:displayname"))</a>
									#if (!$props.getBooleanProperty($props.NamePropIsCollection))
									  ($props.getPropertyFormatted($props.NamePropContentLength))
									#end
									</li>
								#end
								#set ($props = false)
							#end
						</ul>
				#end
				#if ($size == 0) No attachments ... #end
			</div>
			<div class="chefButtonRow">
			<form name="form2" method="post" action="#toolForm("AnnouncementAction")">
				<input type="submit" name="eventSubmit_doPost" value=" Post " />
                                <input type="submit" name="eventSubmit_doPreviewrevise" value="Revise" />
				<input type="submit" name="eventSubmit_doSavedraft" value="Save Draft" /> 
				<input type="submit" name="eventSubmit_doPreviewrevise" value="Cancel" />
			</form>
			</div>
	</div>
</div>
