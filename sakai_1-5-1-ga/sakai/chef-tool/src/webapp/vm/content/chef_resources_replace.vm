##<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/content/chef_resources_replace.vm,v 1.7 2005/01/20 14:47:40 zqian.umich.edu Exp $ -->
## Note: a paitence display is required here %%% -ggolden
<div class="chefPortletContainer">
	<div class ="chefPortletToolBarMessage">
		Replacing file...
	</div>
	<div class="chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
		<div class ="chefBreadCrumb">
			Location:
			<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder" />
			#foreach ($id in $collectionPath)
				#if ($dropboxMode && $id==$homeCollection)
					$siteTitle Drop Box /
				#else
					$validator.escapeHtml($service.getProperties($id).getPropertyFormatted($resourceProperties.NamePropDisplayName)) /
				#end
			#end
			#if ($dropboxMode && $collectionId==$homeCollection)
				$siteTitle Drop Box
			#else
				$validator.escapeHtml($service.getProperties($collectionId).getPropertyFormatted($resourceProperties.NamePropDisplayName))
			#end
		</div>
		<div class="chefPageviewTitle">
			Replace file with a new file or different version? The replacement will remove the current file and let you upload a replacement. Have your new file ready to send!
		</div>
		<form name="replaceFileBasicForm" action="#toolForm("ResourcesAction")&special=upload" method="post" enctype="multipart/form-data">
			<input type="hidden" name="collectionId" value="$validator.escapeHtml($collectionId)" />
			<input type="hidden" name="replaceItems" value="$replaceItems" />
			<input type="hidden" name="eventSubmit_doReplacefile" value="x" />
			<input type="hidden" name="option" value="replace" />
				#foreach ( $i in [1 ..$replaceNumber] )
					#set($item=$replaceItems.get($i))
					<fieldset>
						<legend>
							File:  $validator.escapeHtml($service.getResource($item).getProperties().getPropertyFormatted($service.getResource($item).getProperties().NamePropDisplayName))
						</legend>						
						<table class ="chefEditItem">
							<tr>
								<td class="chefLabel">
									#if ($unqualified_fields.get($i).indexOf($service.newResourceProperties().NamePropDisplayName)!=-1)
										<span class="chefAlert">Replace with this file:</span>
									#else
										Replace with this file:
									#end
								</td>
								<td>
									#if ($osNames.get($i).length()==0)
										<input type="file" name="fileName$i" class ="upload" />
									#else
										$osNames.get($i)<br />
										To change: <br />
										<input type="file" name="fileName$i" size="20" />
									#end
								</td>
						  </tr>
							<tr> 
								<td class ="chefLabel">
									#if (($titles.get($i).length()>0) && ($unqualified_fields.get($i).indexOf($titles.get($i))!=-1))
										<span class="chefAlert">Title:</span>
									#else
										Title:
									#end
								</td>
								<td>
									<input type="text" name="title$i" value="$titles.get($i)" size="40" />
								</td>
							</tr>
						</table>
					</fieldset>
					#if (!$dropboxMode)
						#if ($notification)
							<table>
									<tr>
									<td style="vertical-align:middle">Email Notification:</td>
									<td>
										<select name="notify">
											<option value="r">High - All participants</option>
											<option value="o">Low - Only participants who have opted in</option>
											<option value="n" selected="selected">None - No notification</option>
										</select>
									</td>
								</tr>
							</table>
						#end
					#end
				#end
			<div class ="chefButtonRow">
				#if ($replaceNumber>1)
					#set ($buttonName = "Replace Items")
				#else
					#set($buttonName = "Replace Item")
				#end
				## showNotif parameters: 1) id of the span that should show ('submitnotif'), 2) name of the input to disable (no spaces,hope that is OK), 3) name of the form)
				## call the showNotif function first - set 1st parameter to 'noNotif' > notification will remain hidden, 2nd parameter to 'noBlock'  > submit button will not be disabled
				<input 
					type="button" 
					name="replace" 
					id="replace" 
					value="$buttonName"
					onClick="showNotif('submitnotif','replace','replaceFileBasicForm');document.replaceFileBasicForm.option.value='replace'; document.replaceFileBasicForm.submit(); return false;"
				/>
				<input 
					type="button" 
					name="Cancel" 
					id="Cancel" 
					value="Cancel"
					onClick="document.replaceFileBasicForm.option.value='cancel'; document.replaceFileBasicForm.submit(); return false;"
				/>
				<span id="submitnotif" style="visibility:hidden">Processing......</span>	
			</div>
		</form>
	</div>
</div>
