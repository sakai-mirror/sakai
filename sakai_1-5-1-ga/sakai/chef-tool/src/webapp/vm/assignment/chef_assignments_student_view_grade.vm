##<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/assignment/chef_assignments_student_view_grade.vm,v 1.3 2004/06/25 20:25:04 janderse.umich.edu Exp $ -->
<div class="chefPortletContainer">
	#set ($assignment = $submission.Assignment)
	<div class="chefPortletToolBarMessage">
		Viewing assignment's grade ...
	</div>
	<div class="chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
		<form action="#toolForm("AssignmentAction")" method="post" >
                    <fieldset>
                    <legend>Assignment</legend>
			<table class="chefItemDetail" summary="The grading detail of assignment submission">
					<tr>
                                                <td class="chefLabel">
                                                    Title:
                                                </td>
						<td valign="top">
							$validator.escapeHtml($assignment.title)
						</td>
                                        </tr>
					<tr>
						<td class="chefLabel">
                                                    Student:
                                               </td>
						<td valign="top">
							#set ($submitters = $submission.submitters)
							#foreach ($submitter in $submitters)
								$submitter.DisplayName<br />
							#end
                                                </td>
                                        </tr>
					<tr>
                                                <td class="chefLabel">
								Submitted: 
						</td>
						<td valign="top">	
							$submission.TimeSubmitted.toStringLocalFull()<br />
                                                </td>
                                        </tr>
					<tr>
							<td class="chefLabel">
								Grade: 
							</td>
                            <td valign="top">
							#if (($submission.Graded) && ($submission.GradeReleased || $submission.Returned))
								##show grade when release or returned
								#if ($assignment.getContent().TypeOfGrade != 1)
									$submission.GradeDisplay
								#else
									No grade
								#end
							#else
								#if ($submission.Returned)
									#if ($submission.TimeReturned.before($submission.TimeSubmitted))
										Returned $submission.TimeReturned.toStringLocalFull()
										#if ($submission.Graded)	
											, $submission.GradeDisplay
										#end
									#else
										Re-submitted $submission.TimeSubmitted.toStringLocalFull()
										#if ($submission.getTimeSubmitted().after($assignment.DueTime))
											<span class="chefAlert"> late</span>
										#end
									#end
								#else
									Ungraded
								#end
							#end
							#set ($gradeScale = $assignment.getContent().getTypeOfGradeString($assignment.getContent().getTypeOfGrade()))
							#if ($gradeScale == "Points")
								(max $assignment.getContent().getMaxGradePointDisplay())
							#end
						</td>
					</tr>
					<tr>
						<td colspan="5">
							<div class="chefSectionTitle">
								Instructions:
							</div>
							<div class="chefSectionContent">
								#if ($!assignment.getContent().getInstructions().length()>0)
									<span class="chefPre">$validator.escapeHtmlFormattedText($!assignment.getContent().getInstructions())</span>
								#else
									<i>&lt;none&gt;</i>
								#end
							</div>
						</td>
					</tr>
					<tr valign="top">
						<td height="32" colspan="5">
							#set ($attachments = $assignment.getContent().Attachments)
							#set ($size = 0)
							<fieldset class="chefAttachmentsF">
								<legend class="chefAttachmentsL">	
									Additional resources for assignment
								</legend> 
								#set ($size = 0)
								#set ($props = false)
								#foreach ($attachment in $attachments) 
									#set ($props = $attachment.Properties) 
									#if ($!props)
										#set ($size = $size + 1)
									#end
								#end
								#if ($size == 0)
									No attachments ...
								#else
									<ul class="chefAttachmentList">
										#foreach ($attachment in $attachments) 
											#set ($props = false)
											#set ($props = $attachment.Properties) 
											#if ($!props)
												<li>
													#if ($props.getBooleanProperty($props.NamePropIsCollection))
														<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder attachment" />
													#else
														<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="File attachment" />
													#end
													<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
													#if (!$props.getBooleanProperty($props.NamePropIsCollection))
														($props.getPropertyFormatted($props.NamePropContentLength))
													#end
												</li>
											#end
										#end
									</ul>
								#end	
							</fieldset>
						</td>
					</tr>
                                        </table>
                                        </fieldset>
                                        <fieldset>
                                        <legend>Instructor's comments</legend>
                                        <table class="chefItemDetail">
					<tr>
						<td colspan="5">
							<table border="0" width="100%">
								#if ($!submission.FeedbackText && ($submission.FeedbackText.length()>0))
									<tr valign="top">
										<td colspan="5" valign="bottom">
											<div class="chefSectionTitle">
												Original submission text and attachment(s) with the instructor's comments inserted if applicable:
											</div>
											<div class="chefSectionContent">
												<span class="chefPre">$cheffeedbackhelper.escapeAssignmentFeedback($submission.FeedbackText)</span>
											</div>
										</td>
									 </tr>
								 #end
								<tr valign="top">
									<td colspan="5" valign="bottom" nowrap>
										#set ($submittedAttachments = $submission.SubmittedAttachments)
										<fieldset class="chefAttachmentsF">
											<legend class="chefAttachmentsL">	
												Student attachments
											</legend> 
											#set ($size = 0)
											#set ($props = false)
											#foreach ($attachment in $submittedAttachments) 
												#set ($props = $attachment.Properties) 
												#if ($!props)
													#set ($size = $size + 1)
												#end
											#end
											#if ($size == 0)
												No attachments ...
											#else
												<ul class="chefAttachmentList">
													#foreach ($attachment in $submittedAttachments) 
														#set ($props = false)
														#set ($props = $attachment.Properties) 
														#if ($!props)
															<li>
																#if ($props.getBooleanProperty($props.NamePropIsCollection))
																	<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder attachment" />
																#else
																	<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="File attachment" />
																#end
																<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
																#if (!$props.getBooleanProperty($props.NamePropIsCollection))
																	($props.getPropertyFormatted($props.NamePropContentLength))
																#end
															</li>
														#end
													#end
												</ul>
											#end	
										</fieldset>
									</td>
								 </tr>
								<tr valign="top">
									<td colspan="5" valign="bottom">
										<div class="chefSectionTitle">
											Additional instructor's comments about your submission:
										</div>
										<div class="chefSectionContent">
											#if (($!submission.FeedbackComment) && ($submission.FeedbackComment.length()>0))
												<span class="chefPre">$validator.escapeHtmlFormattedText($submission.FeedbackComment)</span>
											#else
												&lt;none&gt;
											#end
										</div>
									</td>
								</tr>
								<tr>
									<td colspan="5">
										<table border="0" cellpadding="5" width="100%">
											<tr>
												<td valign="top" colspan="2">
													#set ($size = 0)
													#set ($props = false)
													#set ($feedbackAttachments = $submission.FeedbackAttachments)
													<fieldset class="chefAttachmentsF">
														<legend class="chefAttachmentsL">	
                                                                                                                        Additional resources for grade
														</legend>
														#set ($size = 0)
														#set ($props = false)
														#foreach ($attachment in $feedbackAttachments) 
															#set ($props = $attachment.Properties) 
															#if ($!props)
																#set ($size = $size + 1)
															#end
														#end
														#if ($size == 0)
															No attachments ...
														#else
															<ul class="chefAttachmentList">
																#foreach ($attachment in $feedbackAttachments) 
																	#set ($props = false)
																	#set ($props = $attachment.Properties) 
																	#if ($!props)
																		<li>
																			#if ($props.getBooleanProperty($props.NamePropIsCollection))
																				<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder attachment" />
																			#else
																				<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="File attachment" />
																			#end
																			<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
																			#if (!$props.getBooleanProperty($props.NamePropIsCollection))
																				($props.getPropertyFormatted($props.NamePropContentLength))
																			#end
																		</li>
																	#end
																#end
															</ul>
														#end
													</fieldset>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
                        </fieldset>
<div class="chefButtonRow">
<input type="submit" name="eventSubmit_doCancel_view_grade" value="Done" />
</div>
			</form>
                 
	</div>
</div>