## $Header: /cvs/sakai2/legacy/tools/src/webapp/vm/content/chef_resources_addFileBasic.vm,v 1.12 2005/06/03 14:55:17 gsilver.umich.edu Exp $ 
## #paitence("upload") %%%  currently disabled -ggolden

<script type="text/javascript" language="JavaScript">
  focus_path = ["filename1"];
</script>
<div class="portletBody" id="chefPortletContainer">
	<h3>
		$tlang.getString("gen.additems")
	</h3>
	<script type="text/javascript">
		function openSampleCopyrightWindow() 
		{ 
		  window.open("$copyright_alert_url","SampleCopyrightAlert","scrollbars=no,menubar=no,height=400,width=700,resizable=no,toolbar=no,location=no,status=no");
		  return false;
		}
		function enableNewCopyright(obj_mycopyright, obj_newcopyright)
		{
			obj_mycopyright.checked = false;
			obj_newcopyright.checked = true;
		}

		function clearNewCopyright(obj_textarea)
		{
			obj_textarea.value = "";
		}
		
		function checkItem(copyrightIndex, fileIndex)
		{
			var obj_alert_name="copyrightAlert"+fileIndex;
			var obj_alert_item=document.getElementById(obj_alert_name);
			var obj_newcopyright_name="newcopyright"+fileIndex;
			var obj_newcopyright_item=document.getElementById(obj_newcopyright_name);
			if (copyrightIndex == 0)
			{
				obj_alert_item.checked=false;
				obj_newcopyright_item.disabled=true;
			}
			else if (copyrightIndex < 5)
			{
				obj_alert_item.checked=true;
				obj_newcopyright_item.disabled=true;
			}
			else if (copyrightIndex == 5)
			{
				obj_alert_item.checked=true;
				obj_newcopyright_item.disabled=false;
			}
		}
	</script>

	#if ($alertMessage)<div class="chefAlertBox">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div style="display:block;clear:both" ></div>#end
	<p class="instruction">
		$tlang.getString("gen.instr1")
	</p>	
	<p class="instruction">
		$tlang.getString("gen.instr2") <span class="reqStarInline">*</span>  
	</p>
	
	<div class ="breadCrumb indnt1">
		<label><strong>$tlang.getString("gen.location")</strong></label>
		<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="$tlang.getString('gen.folder')" />
		#foreach ($id in $collectionPath)
			#if ($dropboxMode && $id==$homeCollection)
				$siteTitle Drop Box /
			#else
				$validator.escapeHtml($service.getProperties($id).getPropertyFormatted($resourceProperties.NamePropDisplayName)) /
			#end
		#end
		#if ($dropboxMode && $collectionId==$homeCollection)
			$siteTitle Drop Box
		#else
			$validator.escapeHtml($service.getProperties($collectionId).getPropertyFormatted($resourceProperties.NamePropDisplayName))
		#end
	</div>		

	<form name="addItemForm" id="addItemForm" method="post" action="#toolForm("ResourcesAction")" >
		<input type="hidden" name="from" value="list" />
		<input type="hidden" name="sakai_action" value="doAdditem" />
		<input type="hidden" name="collectionId" value="$validator.escapeHtml($collectionId)" />
		<p class="shorttext">
			<label for="itemType">$tlang.getString("addi.change")</label>
			<select id="itemType"  name="itemType" onchange="javascript:document.forms.addItemForm.submit();">
				<option value="file" id="file" selected="selected">$tlang.getString("addi.upload")</option>
				<option value="Url" id="Url">$tlang.getString("addi.url")</option>
				<option value="htmldocument" id="htmldocument">$tlang.getString("addi.txthtml")</option>
				<option value="plaintextdocument" id="plaintextdocument">$tlang.getString("addi.txttxt")</option>
			</select>
		</p>
	</form>		
	<form 
		name="addFileBasicForm" 
		id="addFileBasicForm" 
		action="#toolForm("ResourcesAction")&special=upload" 
		method="post" 
		enctype="multipart/form-data">
		<input type="hidden" name="from" value="list" />
		<input type="hidden" name="collectionId" value="$validator.escapeHtml($collectionId)" />
		<input type="hidden" name="addFileStep" value="basic" />
		<input type="hidden" name="stateName" value = "addFileBasic" />
		<input type ="hidden" name = "itemType" value="file" />
		<input type="hidden" name="eventSubmit_doAdd_file_basic" value="x" />
		<input type="hidden" name="option" value="change" />
		<p class="shorttext">
			<label for="select">$tlang.getString("add.select")</label>
			<select name="fileNumber" id="select" onchange="javascript:document.addFileBasicForm.submit();">
				#foreach ($i in [1 .. 10])
					#if ($i==$currentFileNumber)
						<option value="$i" selected="selected">$i</option>
					#else
						<option value="$i">$i</option>
					#end
				#end
			</select>
		</p>	
			<br />		
		#foreach( $i in [1 ..$currentFileNumber] )
			#if ($currentFileNumber == 1)
				<h4>$tlang.getString("addi.upload")</h4>
			#else
				<h4>$tlang.getString("addi.upload") ($i of $currentFileNumber)</h4>
			#end
			<p class="shorttext">
				<span class="reqStar">*</span>
				<label for="filename$i">
					#if ($unqualified_fields.get($i).indexOf("osname")!=-1)
						$tlang.getString("gen.choose") $tlang.getString("add.afile")
					#else
						$tlang.getString("gen.choose") $tlang.getString("add.afile")
					#end
				</label>
				#if ($osNames.get($i).length()==0)
					 <input type="file" name="filename$i" id="filename$i"  class ="upload" />
				#else
					$osNames.get($i)<br />
					To change: <br />
					<input type="file" name="filename$i" size="20" class ="upload" />
				#end
			</p>

			<h4>$tlang.getString("gen.properties")</h4>
			<p class="shorttext">
				<span class="reqStar">*</span>
				<label for="title$i">
					#if (($titles.get($i).length()>0) && ($unqualified_fields.get($i).indexOf($service.newResourceProperties().NamePropDisplayName)!=-1))
						$tlang.getString("gen.title")
					#else
					 $tlang.getString("gen.title")
					#end
				</label>	
					<input type="text" name ="title$i" id ="title$i"   value="$titles.get($i)" size="40" />
				</p>	
				<p class="shorttext">
					<label for="description$i">
							$tlang.getString("gen.description")
					</label>
					<textarea id="description$i" name="description$i" rows="3" cols="40" wrap="virtual">$validator.escapeHtmlTextarea($descriptions.get($i))</textarea>
				</p>
				#set($isCollection = "$!{properties.getPropertyFormatted($properties.NamePropIsCollection)}")

				<!-- isCollection == $isCollection -->
				<!-- copyrightTypes == $copyrightTypes -->
				#if ("$isCollection"!="true") 
					#if ($!copyrightTypes)
						<p class="shorttext">
							<span class="reqStar">*</span>
							<label for="copyright$i">
								$tlang.getString("edit.cstatus")
							</label>								
							<select name="copyright$i" id ="copyright$i">
								#foreach ($copyright in $copyrightTypes)
									<option value="$copyright"#if($copyrightChoice == $copyright) selected="selected"#end>$copyright</option>
								#end
							</select>
							#if($fairuseurl)
								(<a href="$fairuseurl" target="_blank">$tlang.getString("edit.fairuse")</a>)
							#end
						</p>
						<p class="shorttext">
							<label for="newcopyright$i">
								$tlang.getString("edit.cinfo")
							</label>	
							<textarea name="newcopyright$i" id="newcopyright$i" rows="1" cols="40" wrap="virtual" >$validator.escapeHtmlTextarea("$!newcopyright")</textarea><br />
						</p>
						<p class="shorttext">
							<label for="copyrightAlert$i">
								$tlang.getString("edit.calert")
							</label>	
								<input type="checkbox" style="bnorder:none" name="copyrightAlert$i" id ="copyrightAlert$i" value="true" #if($copyrightAlert)checked="checked"#end) style="border:none"/>
								$tlang.getString("edit.display1")
								<a href="#" onclick="javascript:openSampleCopyrightWindow();">$tlang.getString("edit.display2")</a>
								$tlang.getString("edit.display3")
							</p>
					#end
				#end
					## not show the public view in dropbox
					#if (!$dropboxMode)
						<p class="shorttext">
							<label for="pubview$i">
								$tlang.getString("edit.access1")
							</label>	
							<input type="checkbox" name="pubview$i" id="pubview$i" value="true" #if($pubview) checked="checked"#end style="border:none" />
							#set ($pubview = $pubviews.get($i))
							#if ($pubviewset)
								$tlang.getString("gen.setyes")
							#else
								$tlang.getString("edit.access2")
							#end
						</p>
					#end
				#end
				## not show notification in dropbox
				#if (!$dropboxMode && ($notification))
					<p class="shorttext"> 
						<label for="notify">
							$tlang.getString("gen.email1")
						</label>	
						<select id="notify" name="notify">
							<option value="r">$tlang.getString("gen.email2")</option>
							<option value="o">$tlang.getString("gen.email3")</option>
							<option value="n" selected="selected">$tlang.getString("gen.email4")</option>
						</select>
					</p>
				#end
		<p class ="act">
## showNotif parameters: 1) id of the span that should show ('submitnotif'), 2) name of the input to disable (no spaces,hope that is OK), 3) name of the form)
## call the showNotif function first - set 1st parameter to 'noNotif' > notification will remain hidden, 2nd parameter to 'noBlock'  > submit button will not be disabled
			<input
				type="button" 
				name="AddFile" 
				class="active" 
				id="addfile" 
				value="$tlang.getString("gen.add")"
				onclick="showNotif('submitnotif','AddFile','addFileBasicForm'); document.addFileBasicForm.option.value='add'; document.addFileBasicForm.submit(); return false;"
			/>
			<input 
				type="submit" 
				name="Cancel" 
				id="Cancel" 
				value="$tlang.getString("gen.cancel")"
				onclick="document.addFileBasicForm.option.value='cancel'; document.addFileBasicForm.submit(); return false;"
			/>
		<span id="submitnotif" style="visibility:hidden">$tlang.getString("gen.proces")</span>	
		</p>
		<strong>$tlang.getString("gen.note")</strong> $tlang.getString("gen.onlyup1")$!maxUploadSize$tlang.getString("gen.onlyup2")
	</form>
</div>

