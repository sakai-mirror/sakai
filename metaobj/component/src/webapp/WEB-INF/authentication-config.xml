<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
  - Application context loaded by ContextLoaderListener if NOT using container adapters
  - $Id: authentication-config.xml,v 1.1 2005/06/29 18:36:41 chmaurer Exp $
  -->

<beans default-lazy-init="true" >

   <bean id="authManager" class="org.sakaiproject.metaobj.security.impl.sakai.AuthnManager">
      <property name="ospiIdManager"><ref bean="idManager"/></property>
   </bean>

   
   <bean id="explicitAuthz" class="org.sakaiproject.metaobj.security.impl.sakai.WorksiteAwareAuthorizationFacade" >
      <property name="sessionFactory"><ref bean="sessionFactory"/></property>
      <property name="authManager"><ref bean="authManager"/></property>
      <property name="agentManager"><ref bean="agentManager"/></property>
      <property name="sakaiSecurityBase">
         <bean id="org.sakaiproject.metaobj.security.impl.sakai.SecurityBase"
            class="org.sakaiproject.metaobj.security.impl.sakai.SecurityBase">
            <property name="ospiIdManager"><ref bean="idManager"/></property>
         </bean>
      </property>
   </bean>

   <bean id="authzManager" class="org.sakaiproject.metaobj.security.app.AuthorizationFacadeImpl" >
      <property name="authManager"><ref bean="authManager"/></property>
      <property name="explicitAuthz"><ref bean="explicitAuthz"/></property>
      <property name="applicationAuthorizers">
         <list>
<!--             <ref bean="repositoryAuthz"/> -->
            <ref bean="worksiteAuthz"/>
         </list>
      </property>
   </bean>

   <bean id="worksiteAuthz" class="org.sakaiproject.metaobj.security.impl.sakai.WorksiteAuthorizer">
      <property name="functions">
         <list>
            <bean id="org.sakaiproject.metaobj.worksite.mgt.WorksiteManager.WORKSITE_MAINTAIN" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.worksite.mgt.WorksiteManager.WORKSITE_MAINTAIN</value></property>
            </bean>
         </list>
      </property>
   </bean>

<!--
<bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.READ" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean"/>
-->
<!-- 
   <bean id="repositoryAuthz" class="org.sakaiproject.metaobj.repository.mgt.RepositoryAuthorizerImpl">
      <property name="homeFactory"><ref bean="homeFactory"/></property>
      <property name="nodeMetadataService">
          <ref bean="org.sakaiproject.metaobj.repository.intf.NodeMetadataService"/>
      </property>
      <property name="repositoryManager"><ref bean="repositoryManager"/></property>
      <property name="idManager"><ref bean="idManager"/></property>
      <property name="lockManager"><ref bean="lockManager"/></property>
      <property name="functions">
         <list>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.READ.repositoryAuthz" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.READ</value></property>
            </bean>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.OWNER" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.OWNER</value></property>
            </bean>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.WRITE" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.WRITE</value></property>
            </bean>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.DELETE" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.DELETE</value></property>
            </bean>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.EDIT" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.EDIT</value></property>
            </bean>
            <bean id="org.sakaiproject.metaobj.repository.RepositoryFunctions.MOVE" class="org.sakaiproject.metaobj.utils.ioc.FieldRetrievingFactoryBean">
               <property name="staticField"><value>org.sakaiproject.metaobj.repository.RepositoryFunctions.MOVE</value></property>
            </bean>
         </list>
      </property>
   </bean>

   <bean id="org.sakaiproject.metaobj.security.mgt.PermissionManager"
         class="org.sakaiproject.metaobj.security.mgt.impl.PermissionManagerImpl" >
      <property name="authzManager"><ref bean="authzManager"/></property>
      <property name="agentManager"><ref bean="agentManager"/></property>
      <property name="tools">
         <map>
            <entry key="repository">
               <ref bean="org.sakaiproject.metaobj.security.mgt.ToolPermissionManager.repository"/>
            </entry>

         </map>
      </property>
   </bean>
-->

</beans>
