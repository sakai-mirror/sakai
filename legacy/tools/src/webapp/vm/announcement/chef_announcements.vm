## $Header: /cvs/sakai2/legacy/tools/src/webapp/vm/announcement/chef_announcements.vm,v 1.10 2005/05/28 03:04:35 ggolden.umich.edu Exp $
## this is showing the list view of all announcement, and the home view of this tool

##(gsilver - remaining issues: trimming body, <p> in body when produced with WYS, the fact that how thing look in the synopsys is still undefined - and finally - the permissions nightmare as well as the ling to Remove...

<div class="portletBody">
	#if ($isOnWorkspaceTab.equals("false"))
		#if($menu && $EnabledMenuItemExists)
			#if ($toolId == "sakai.synoptic.announcement")
				<div class="chefToolBarWrap">
					<a href="#" title="$tlang.getString("gen.recopt")" onclick="location = '#toolLink("$action" "doOptions")';return false;">
						$tlang.getString("custom.options")
					</a>
				</div>
			#else
				#toolbar($menu)
			#end
		#end
	#end

	#set ($SiteColumnFlag = 0)
	#foreach ($item in $showMessagesList2)
		#set ($itemChannel = $validator.escapeHtml($item.channelDisplayName))
			#if (!$currentChannelDisplayName.equals($itemChannel))
				#set ($SiteColumnFlag = $SiteColumnFlag + 1)
			#end
	#end
	
	#if ($isOnWorkspaceTab.equals("true")) ##in workspace
		<h3>Announcements</h3>
		#if ($alertMessage)<div class="chefAlertBox">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div style="display:block;clear:both" />#end

			#if (!$messageListVector.iterator().hasNext())
				<p class="instruction">
					$tlang.getString("gen.thereare")
				</p>
			#else
				
				<div class="rightNav">
					<span class="instruction">
						Viewing $topMsgPos - $btmMsgPos of $allMsgNumber items
					</span>
					#if ($pagesize != 0)
						#if ($goFPButton == "true")
							<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_first" value="|<" title="$tlang.getString("gen.first")" />
							</form>
						#else
							<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_first" value="|<" disabled="disabled" />
							</form>
						#end
						#if ($goPPButton == "true")
							<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_prev" value="<" title="$tlang.getString('gen.previous') $pagesize" />
							</form>
						#else
							<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_prev" value="<" disabled="disabled" />
							</form>
						#end
					#end	
					<form name="pagesizeForm" style="display:inline" method="post" action="#toolForm("$action")">
						<input type="hidden" name="eventSubmit_doChange_pagesize" value="changepagesize" />
						<select name="selectPageSize" onchange="blur();document.pagesizeForm.submit();">
							<option value="5" #if($pagesize == 5) selected="selected" #end>$tlang.getString("gen.show5")</option>
							<option value="10" #if($pagesize == 10) selected="selected" #end>$tlang.getString("gen.show10")</option>
							<option value="20" #if($pagesize == 20) selected="selected" #end>$tlang.getString("gen.show20")</option>
							<option value="50" #if($pagesize == 50) selected="selected" #end>$tlang.getString("gen.show50")</option>
							<option value="100" #if($pagesize == 100) selected="selected" #end>$tlang.getString("gen.show100")</option>
							<option value="200" #if($pagesize == 200) selected="selected" #end>$tlang.getString("gen.show200")</option>
						</select>
					</form>
					#if ($pagesize != 0)
						#if ($goNPButton == "true")
							<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_next" value=">" title="$tlang.getString('gen.next') $pagesize" />
							</form>
						#else
							<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_next" value=">" disabled="disabled" />
							</form>
						#end
						#if ($goLPButton == "true")
							<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_last" value=">|" title="$tlang.getString('gen.last')" />
							</form>
						#else
							<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="submit" name="eventSubmit_doList_last" value=">|" disabled="disabled" />
							</form>
						#end
					#end
				</div>
				
				<form name="announcementListForm" action="#toolForm("AnnouncementAction")" method="post">
				<table class="listHier" border="0" cellspacing="0" summary="Table contains list of announcements. First column may contain checkboxes, second will contain the title, third the author, fourth the date. Headers can be used to sort.">
					<tr>
						<th id="attach" style="width:0;padding:0;vertical-align:middle;background-color:transparent"></th>
						<th id ="subject">
							#if (!$currentSortedBy.equals("subject"))
								<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject">Subject</a>
							#else
								#if ($currentSortAsc.equals("true"))
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject ascending">Subject <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by subject ascending" /></a>
								#else
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject ascending">Subject <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt="Sort by subject descending"/></a>
								#end
							#end
						</th>
						<th id="author">
							#if (!$currentSortedBy.equals("from"))
								<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author">From</a>
							#else
								#if ($currentSortAsc.equals("true"))
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author ascending">From <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by author ascending" /></a>
								#else
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author descending">From <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt="Sort by author descending"/></a>
								#end
							#end
						</th>
						#if ($SiteColumnFlag > 0) ## (there are anns from other sites so show what site they are from)
							<th id ="Site">
								#if (!$currentSortedBy.equals("channel"))
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title ="Sort by originating site">Site</a>
								#else
									#if ($currentSortAsc.equals("true"))
										<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title ="Sort by originating site ascending">Site <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by originating site ascending" /></a>
									#else
										<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title ="Sort by originating site ascending">Site <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt="Sort by originating site descending"/></a>
									#end
								#end
							</th>
						#end
						<th id ="date">
							#if (!$currentSortedBy.equals("date"))
								<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="Sort by date ascending">Date</a>
							#else
								#if ($currentSortAsc.equals("true"))
									 <a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="Sort by date ascending">Date <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by date ascending" /></a>
								#else
									<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="Sort by date descending">Date <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt ="Sort by date descending" /></a>
								#end
							#end
						</th>
					</tr>
					#set ($rowCount=0)
					#foreach ($ann_item in $showMessagesList)
						#set ($rowCount =$rowCount + 1)
						<tr>
							<td headers="attach" style="width:.5em;padding:0;vertical-align:middle;">	
								## show the paperclip if existing
									#set ($size = 0)
									#if (!$ann_item.Header.Attachments.isEmpty())
										#set ($props = false)
										#set ($size = $ann_item.Header.Attachments.size())
										#foreach ($attachment in $ann_item.Header.Attachments)
											#set ($props = $attachment.Properties)
											#if (!$props)
													#if ($size > 0) #set ($size = $size - 1) #end
											#end
										#end
									#end
									#if ($size == 0)
									#else
										<img src = "#imageLink("sakai/attachments.gif")" border="0" alt="attachment" />
									#end

							</td>
							<td headers="subject">
								#if ($ann_item.Header.draft)
								<a href="#toolLinkParam("AnnouncementAction" "doReviseannouncement" "itemReference=$ann_item.reference")" title="Edit draft announcement"><span class="chefAlert">$tlang.getString("gen.draft") - </span>
									$validator.escapeHtml($ann_item.Header.subject)</a>
								#else
									<a href="#toolLinkParam("AnnouncementAction" "doShowmetadata" "itemReference=$ann_item.reference")" title="View announcement">
									$validator.escapeHtml($ann_item.Header.subject)</a>
								#end
							</td>
							<td headers="author">
								$validator.escapeHtml($ann_item.Header.From.DisplayName)
							</td>
							#if ($SiteColumnFlag > 0)
								<td headers="channel">
									$validator.escapeHtml($ann_item.channelDisplayName)
								</td>
							#end
							<td headers="date" style="white-space:nowrap">
								$ann_item.Header.Date.toStringLocalFull()
							</td>
						</tr>
						#if ($displayOptions.isShowAnnouncementBody()) 
							<tr>	
									#if ($EnableItemCheckBoxes)
										#if ($SiteColumnFlag > 0)
											#set ($colspan="6")
										#else	
											#set ($colspan="5")
										#end	
									#else
										#if ($SiteColumnFlag > 0)
											#set ($colspan="4")
										#else	
											#set ($colspan="3")
										#end	
									#end	
								<td colspan="$colspan" style="padding:.5em 0 2em .3em">
									$ann_item.TrimmedBody
								</td>
							</tr>	
							#end
					#end
				</table>
			</form>
		#end

	#else ## not in workspace
		#if ($toolId == "sakai.synoptic.announcement") 
		##in home portlet  - so reduce display to title, attach marker, body (if selected), author and date


			#if ($alertMessage)<div class="chefAlertBox">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div style="display:block;clear:both" />#end

			<form name="announcementListForm" action="#toolForm("AnnouncementAction")" method="post" style="margin:1em -.5em;">
				#if (!$messageListVector.iterator().hasNext())
					<p class="instruction"><br />
      					$tlang.getString("gen.thereare")
					</p>
				#else
					#set ($rowCount=0)
					#foreach ($ann_item in $showMessagesList)
						#set ($rowCount =$rowCount + 1)
							#if ($ann_item.Header.draft)
							#else
							<div style="margin:.3em -.2em;">
									<a href="#toolLinkParam("AnnouncementAction" "doShowmetadata" "itemReference=$ann_item.reference")" title="View announcement">
									$validator.escapeHtml($ann_item.Header.subject)</a>
								#end
								#set ($size = 0)
								#if (!$ann_item.Header.Attachments.isEmpty())
									#set ($props = false)
									#set ($size = $ann_item.Header.Attachments.size())
									#foreach ($attachment in $ann_item.Header.Attachments)
										#set ($props = $attachment.Properties)
										#if (!$props)
												#if ($size > 0) #set ($size = $size - 1) #end
										#end
									#end
								#end
								#if ($size == 0)
								#else
									<img src = "#imageLink("sakai/attachments.gif")" border="0" alt="attachment" />
								#end
								#if (!$displayOptions.isShowAnnouncementBody())
										<p style="margin:.2em 1em;font-size:smaller" >($validator.escapeHtml($ann_item.Header.From.DisplayName) - $ann_item.Header.Date.toStringLocalFull())</p>
								#end
							</div>	
						#if ($displayOptions.isShowAnnouncementBody())

## (gsilver) interesting - if created with the WYSIWYG the body is wrapped  in a <p> - then  $ann_item.TrimmedBody returns "<p>trimmed goober<p>..."

							<div style="margin:.3em 0 0 0">
								$ann_item.TrimmedBody
							</div>

							<p style="margin:.3em  0 1em 1em;font-size:smaller">
								($validator.escapeHtml($ann_item.Header.From.DisplayName) - $ann_item.Header.Date.toStringLocalFull())
							</p>	
						#end
					#end
				#end
			</form>

		#else ## not in workspace, not in home

			#if ($toolId == "sakai.announcements") ##In tool or admin MOTD...			

				#if ($displayOptions.isShowAllColumns())
					<h3>Announcements</h3>
					#if ($alertMessage)<div class="chefAlertBox">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div style="display:block;clear:both" />#end

					#if (!$messageListVector.iterator().hasNext())
						<p class="instruction">
							$tlang.getString("gen.thereare")
						</p>
						<form name="announcementListForm" action="#toolForm("AnnouncementAction")" method="post">
						</form>
					#else

						<div class="rightNav">
							<span class="instruction" style="margin-bottom:.3em">Viewing $topMsgPos - $btmMsgPos of $allMsgNumber items</span>
					 			#if ($pagesize != 0)
									#if ($goFPButton == "true")
										<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_first" value="|<" title="$tlang.getString("gen.first")" />
										</form>
									#else
										<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_first" value="|<" disabled="disabled" />
										</form>
									#end
									#if ($goPPButton == "true")
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_prev" value="<" title="$tlang.getString('gen.previous') $pagesize" />
										</form>
									#else
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_prev" value="<" disabled="disabled" />
										</form>
									#end
								#end
							
							<form name="pagesizeForm" style="display:inline" method="post" action="#toolForm("$action")">
								<input type="hidden" name="eventSubmit_doChange_pagesize" value="changepagesize" />
								<select name="selectPageSize" onchange="blur();document.pagesizeForm.submit();">
									<option value="5" #if($pagesize == 5) selected="selected" #end>$tlang.getString("gen.show5")</option>
									<option value="10" #if($pagesize == 10) selected="selected" #end>$tlang.getString("gen.show10")</option>
									<option value="20" #if($pagesize == 20) selected="selected" #end>$tlang.getString("gen.show20")</option>
									<option value="50" #if($pagesize == 50) selected="selected" #end>$tlang.getString("gen.show50")</option>
									<option value="100" #if($pagesize == 100) selected="selected" #end>$tlang.getString("gen.show100")</option>
									<option value="200" #if($pagesize == 200) selected="selected" #end>$tlang.getString("gen.show200")</option>
								</select>
							</form>
							#if ($pagesize != 0)
								#if ($goNPButton == "true")
									<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
										<input type="submit" name="eventSubmit_doList_next" value=">" title="$tlang.getString('gen.next') $pagesize" />
									</form>
								#else
									<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
										<input type="submit" name="eventSubmit_doList_next" value=">" disabled="disabled" />
									</form>
								#end
								#if ($goLPButton == "true")
									<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
										<input type="submit" name="eventSubmit_doList_last" value=">|" title="$tlang.getString("gen.last")" />
									</form>
								#else
									<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
										<input type="submit" name="eventSubmit_doList_last" value=">|" disabled="disabled" />
									</form>
								#end
							#end
						</div>
							
						<form name="announcementListForm" action="#toolForm("AnnouncementAction")" method="post">
							<table class="listHier" border="0" cellspacing="0" summary="Table contains list of announcements. First column may contain checkboxes, second will contain the title, third the author, fourth the date. Headers can be used to sort.">
							<tr>
							 <th id ="attach"  style="width:0;padding:0;vertical-align:middle;background-color:transparent"></th>
							 <th id ="subject">
									#if (!$currentSortedBy.equals("subject"))
										<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject">Subject</a>
									#else
										#if ($currentSortAsc.equals("true"))
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject ascending">Subject <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by subject ascending" /></a>
										#else
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbysubject")';return false;" title ="Sort by subject ascending">Subject <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt="Sort by subject descending"/></a>
										#end
									#end
								</th>
								<th id="author">
									#if (!$currentSortedBy.equals("from"))
										<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author">From</a>
									#else
										#if ($currentSortAsc.equals("true"))
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author ascending">From <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="Sort by author ascending" /></a>
										#else
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbyfrom")';return false;" title ="Sort by author descending">From <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt="Sort by author descending"/></a>
										#end
									#end
								</th>
								#if ($SiteColumnFlag > 0) ## (there are anns from other sites so show what site they are from)
									<th id ="Site">
										#if (!$currentSortedBy.equals("channel"))
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title =$tlang.getString("gen.sortchannel")>$tlang.getString("gen.site")</a>
										#else
											#if ($currentSortAsc.equals("true"))
												<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title =$tlang.getString("gen.sortchanasc")>$tlang.getString("gen.site") <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt=$tlang.getString("gen.sortchanasc") /></a>
											#else
												<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbychannel")';return false;" title =$tlang.getString("gen.sortchandesc")>$tlang.getString("gen.site") <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt=$tlang.getString("gen.sortchandesc")/></a>
											#end
										#end
									</th>
								#end
								#if ($EnableItemCheckBoxes) ## mantain role - so show public value
									<th id="public">
										#if (!$currentSortedBy.equals("public"))
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbypublic")';return false;" title="$tlang.getString("gen.sortbypub")">$tlang.getString("gen.visible")</a>
										#else
											#if ($currentSortAsc.equals("true"))
												 <a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbypublic")';return false;" title="$tlang.getString("gen.sortbypubasc")">$tlang.getString("gen.visible") <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt=$tlang.getString("gen.sortbypubasc") /></a>
											#else
												<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbypublic")';return false;" title="$tlang.getString("gen.sortbypubdesc")">$tlang.getString("gen.visible") <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt =$tlang.getString("gen.sortbypubdesc") /></a>
											#end
										#end
									</th>
								#end
								<th id ="date">
									#if (!$currentSortedBy.equals("date"))
										<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="$tlang.getString("gen.sortbydateasc")">$tlang.getString("gen.date")</a>
									#else
										#if ($currentSortAsc.equals("true"))
											 <a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="$tlang.getString("gen.sortbydateasc")">$tlang.getString("gen.date") <img src = "#imageLink("sakai/sortascending.gif")" border="0" alt="$tlang.getString("gen.sortbydateasc")" /></a>
										#else
											<a href="#" onclick="location='#toolLink("AnnouncementAction" "doSortbydate")';return false;" title="$tlang.getString("gen.sortbydatedesc")">$tlang.getString("gen.date") <img src = "#imageLink("sakai/sortdescending.gif")" border="0" alt ="$tlang.getString("gen.sortbydatedesc")" /></a>
										#end
									#end
								</th>
								#if ($EnableItemCheckBoxes)
									#if ($allow_delete)
										<th id = "checkbox" style="text-align:center">
											$tlang.getString("gen.remove_question")
										</th>
									#end
								#end
							</tr>
							 #set ($rowCount=0)
							 #foreach ($ann_item in $showMessagesList)
								#set ($rowCount =$rowCount + 1)
								<tr>
									<td headers="attach"  style="width:.5em;padding:0;vertical-align:middle;background-color:transparent">
										## show the paperclip if existing
										#set ($size = 0)
										#if (!$ann_item.Header.Attachments.isEmpty())
											#set ($props = false)
											#set ($size = $ann_item.Header.Attachments.size())
											#foreach ($attachment in $ann_item.Header.Attachments)
												#set ($props = $attachment.Properties)
												#if (!$props)
														#if ($size > 0) #set ($size = $size - 1) #end
												#end
											#end
										#end
										#if ($size == 0)
										#else
											<img src = "#imageLink("sakai/attachments.gif")" border="0" alt="attachment" />
										#end
									</td>
									<td headers="subject" style="padding-bottom:0;">
											#if ($ann_item.Header.draft)
											<a href="#toolLinkParam("AnnouncementAction" "doReviseannouncement" "itemReference=$ann_item.reference")" title="Edit draft announcement"><span class="chefAlert">$tlang.getString("gen.draft") - </span>
												$validator.escapeHtml($ann_item.Header.subject)</a>
											#else
												<a href="#toolLinkParam("AnnouncementAction" "doShowmetadata" "itemReference=$ann_item.reference")" title="View announcement">
												$validator.escapeHtml($ann_item.Header.subject)</a>
											#end
										#if ($channel.allowEditMessage($ann_item.Id))
											<div class="itemAction"><a href="#toolLinkParam("AnnouncementAction" "doReviseannouncement" "itemReference=$ann_item.reference")" title="Edit announcement">$tlang.getString("gen.revise")</a></div>
										#end
                                                                                                                                                                                                     
									</td>
									<td headers="author"  style="padding-bottom:0">
										$validator.escapeHtml($ann_item.Header.From.DisplayName)
									</td>
									#if ($SiteColumnFlag > 0)
										<td headers="channel"  style="padding-bottom:0">
											$validator.escapeHtml($ann_item.channelDisplayName)
										</td>
									#end
									#if ($EnableItemCheckBoxes)
										#if ($!ann_item.getProperties().getProperty("SAKAI:pubview") == "true")
											<td  style="padding-bottom:0">
												$tlang.getString("gen.public")
											</td>
										#else
											<td  style="padding-bottom:0">
												$tlang.getString("gen.notpublic")
											</td>
										#end
									#end	
									<td headers="date" style="white-space:nowrap;padding-bottom:0">
										$ann_item.Header.Date.toStringLocalFull()
									</td>
									#if ($channel.allowRemoveMessage($ann_item.Message))
										<td valign="top" headers="checkbox" style="text-align:center; padding-bottom:0">
											<label for ="check-$rowCount" class="skip">$tlang.getString("gen.selectremove")</label>
											<input title="$tlang.getString("gen.selectremove")" type="checkbox" id="check-$rowCount" name="selectedMembers" value="$ann_item.Reference" />
										</td>
									#else
									 	#if ($allow_delete)
											<td valign="top" headers="checkbox" style="text-align:center;padding-bottom:0">
												<label for ="check-$rowCount" class="skip">$tlang.getString("gen.selectremove")</label>
												<input title="$tlang.getString("gen.selectremove")" type="checkbox" id="check-$rowCount" name="selectedMembers" value="$ann_item.Reference" disabled="disabled"/>
											</td>
										#end		
									#end
								</tr>
								#if ($displayOptions.isShowAnnouncementBody()) 
									<tr>
										<td>
										</td>
									## will never be more than 5 cols, so go for the max
										<td colspan="4" style="padding:.2em  0 2em 1.5em;">
											$ann_item.TrimmedBody
										</td>
									</tr>	
									#end
							#end
						</table>
						#end
						#if ($messageListVector.iterator().hasNext())
							#if ($isOnWorkspaceTab.equals("false"))
								#if ($EnableItemCheckBoxes)
									#if ($allow_delete)
										<p class="act">
											<input type="submit" class="active" name="eventSubmit_doDeleteannouncement" value="$tlang.getString("gen.update")" />
											<input type="reset" name="reset" id="reset" value="$tlang.getString("gen.cancel")" />
										</p>
									#end
								#end
							#end
						#end
					</form>
				#else
					<h3>$tlang.getString("gen.announcements")</h3>
					#if ($alertMessage)<div class="chefAlertBox">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div style="display:block;clear:both" />#end

						#if (!$messageListVector.iterator().hasNext())
							<p class="instruction">
            				$tlang.getString("gen.thereare")
							</p>
						#else
						
							<div class="rightNav">
								<span class="instruction">
									##$tlang.getString("gen.viewing") $topMsgPos - $btmMsgPos / $allMsgNumber $tlang.getString("gen.items")
									  $tlang.getString("gen.viewing") $topMsgPos - $btmMsgPos $tlang.getString("gen.separator") $allMsgNumber $tlang.getString("gen.items")
								</span>
								#if ($pagesize != 0)
									#if ($goFPButton == "true")
										<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_first" value="|<" title="$tlang.getString("gen.first")" />
										</form>
									#else
										<form name="firstpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_first" value="|<" disabled="disabled" />
										</form>
									#end
									#if ($goPPButton == "true")
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_prev" value="<" title="$tlang.getString('gen.previous') $pagesize" />
										</form>
									#else
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_prev" value="<" disabled="disabled" />
										</form>									
									#end
								#end
								<form name="pagesizeForm" style="display:inline" method="post" action="#toolForm("$action")">
									<input type="hidden" name="eventSubmit_doChange_pagesize" value="changepagesize" />
									<select name="selectPageSize" onchange="blur();document.pagesizeForm.submit();">
										<option value="5" #if($pagesize == 5) selected="selected" #end>$tlang.getString("gen.show5")</option>
										<option value="10" #if($pagesize == 10) selected="selected" #end>$tlang.getString("gen.show10")</option>
										<option value="20" #if($pagesize == 20) selected="selected" #end>$tlang.getString("gen.show20")</option>
										<option value="50" #if($pagesize == 50) selected="selected" #end>$tlang.getString("gen.show50")</option>
										<option value="100" #if($pagesize == 100) selected="selected" #end>$tlang.getString("gen.show100")</option>
										<option value="200" #if($pagesize == 200) selected="selected" #end>$tlang.getString("gen.show200")</option>
									</select>
								</form>
								#if ($pagesize != 0)
									#if ($goNPButton == "true")
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_next" value=">" title="$tlang.getString('gen.next') $pagesize" />
										</form>
									#else
										<form name="nextpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_next" value=">" disabled="disabled" />
										</form>
									#end				
						        	#if ($goLPButton == "true")
										<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_last" value=">|" title="$tlang.getString("gen.last")" />
										</form>
									#else
										<form name="lastpageForm" style="display:inline" method="post" action="#toolForm("$action")">
											<input type="submit" name="eventSubmit_doList_last" value=">|" disabled="disabled" />
										</form>
									#end
								#end
								<br />
							</div>
			
							<form name="announcementListForm" action="#toolForm("AnnouncementAction")" method="post">
						
							<table class="listHier" border="0" cellspacing="0" summary="Table contains list of announcements.">
							 #set ($rowCount=0)
							 #foreach ($ann_item in $showMessagesList)
								#set ($rowCount =$rowCount + 1)
								<tr>
									 <td width="20%" style="padding-bottom:0;font-size:1.3em" >
											#if ($ann_item.Header.draft)
											<a href="#toolLinkParam("AnnouncementAction" "doReviseannouncement" "itemReference=$ann_item.reference")" title="$tlang.getString("gen.editdraft")"><span class="chefAlert">$tlang.getString("gen.draft") - </span>
												$validator.escapeHtml($ann_item.Header.subject)</a>
											#else
												<a href="#toolLinkParam("AnnouncementAction" "doShowmetadata" "itemReference=$ann_item.reference")" title="$tlang.getString("gen.viewann")">
												$validator.escapeHtml($ann_item.Header.subject)</a>
											#end
											#set ($size = 0)
											#if (!$ann_item.Header.Attachments.isEmpty())
												#set ($props = false)
												#set ($size = $ann_item.Header.Attachments.size())
												#foreach ($attachment in $ann_item.Header.Attachments)
													#set ($props = $attachment.Properties)
													#if (!$props)
															#if ($size > 0) #set ($size = $size - 1) #end
													#end
												#end
											#end
											#if ($size == 0)
											#else
												<img src = "#imageLink("sakai/attachments.gif")" border="0" alt="attachment" />
											#end
										</td>
										#if (!$displayOptions.isShowAnnouncementBody())
											<td style="padding-bottom:0">
										/	($validator.escapeHtml($ann_item.Header.From.DisplayName) - $ann_item.Header.Date.toStringLocalFull())
											</td>
										#end
										<td style="padding-left:3em;padding-bottom:0">
											#if ($channel.allowEditMessage($ann_item.Id))
												<a href="#toolLinkParam("AnnouncementAction" "doReviseannouncement" "itemReference=$ann_item.reference")" title="$tlang.getString("gen.editann")">$tlang.getString("gen.revise")</a>
											#end

											#if ($channel.allowEditMessage($ann_item.Id))
												#if ($channel.allowRemoveMessage($ann_item.Message))
												
												#end
											#end
											#if ($channel.allowRemoveMessage($ann_item.Message))
											| <a href="#toolLinkParam("AnnouncementAction" "doDelete_announcement_link" "itemReference=$ann_item.reference")" 	title="$tlang.getString("gen.removeann")">$tlang.getString("gen.delete")</a>
											#end
										</td>
									#if ($displayOptions.isShowAnnouncementBody())
										<tr>
											## need to test this with the WYSIWIG - if a <p> is created...										
											<td colspan="2" class="body" style="padding-top:0">
													<p>$ann_item.TrimmedBody</p>
													<p style="margin:.5em 0 1em 3em !important">
														($validator.escapeHtml($ann_item.Header.From.DisplayName) - $ann_item.Header.Date.toStringLocalFull())
													</p>	
											</td>
										</tr>
									#end
								#end
						</table>
						</form>
					#end
				#end
			#end
		#end
	#end	
</div>
