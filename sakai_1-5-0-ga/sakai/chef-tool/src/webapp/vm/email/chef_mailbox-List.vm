##<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/email/chef_mailbox-List.vm,v 1.3 2004/09/15 17:32:59 ggolden.umich.edu Exp $ -->
<script type="text/javascript" language="JavaScript">
  focus_path = ["search"];
</script>
<div class="chefPortletContainer">
	#if($menu)#toolbar($menu)#end
	<div class="chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
		#if ($sort-order)
			#set ($sort-img = "chef/sortascending.gif")
			#set ($sort-dir = "ascending")
		#else
			#set ($sort-img = "chef/sortdescending.gif")
			#set ($sort-dir = "descending")
		#end
		<div class="chefPageviewTitle">
			#if ($validFrom)
				You are authorized to send email#if($validFrom != "*") from: $validFrom#else.#end<br /><br />
				Email sent to the following addresses will be archived and sent to participants:<br />
				<ul  style="margin:15px">
					#foreach ($alias in $aliases)
						<li style="margin:5px 5px 5px 15px;list-style-type: none;">${alias.getId()}@${serverName}</li>
					#end
					<li style="margin:5px 5px 5px 15px;list-style-type: none;">${nonAlias}@${serverName}</li>
				</ul>
			#else
				You are not authorized to send mail to this worksite.<hr />
			#end
			#if($num-messages)<br/>Total number of messages: $num-messages.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#end
		</div>
		#if($num-messages > 0)
			<div class="chefPageviewTitle">
				To view a message click the subject.
			</div>
			<table class ="chefFlatListViewTable" cellspacing="0" summary ="List of archived email">
				<tr>
					<th id="from">
						<a href="#" onclick = "location = '#toolLink($action "doSort_from")';return false;" title ="Sort by sender">
							From
							#if ($sort-by == 0)<img border="0" src="#imageLink($sort-img)" alt="Sort by sender $sort-dir" />#end
						</a>
					</th>
					<th id="subject">
						<a href="#" onclick = "location = '#toolLink($action "doSort_subject")';return false;" title = "Sort by subject">
							Subject
							#if ($sort-by == 2)<img border="0" src="#imageLink($sort-img)" alt="Sort by subject $sort-dir" />#end
						</a>
					</th>
					<th id="date">
						<a href="#" onclick = "location = '#toolLink($action "doSort_date")';return false;" title ="Sort by date sent">
							Sent
							#if ($sort-by == 1)<img border="0" src="#imageLink($sort-img)" alt ="Sort by date sent $sort-dir" />#end
						</a>
					</th>
				</tr>
				#foreach ($item in $messages)
					<tr>
						<td headers="from">$validator.escapeHtml($item.Header.FromAddress)</td>
						<td headers="subject">
							<a href="#" onclick="location = '#toolLink($action "doView")&$view-id=$item.Header.Id';return false;">
								$validator.escapeHtml($item.Header.Subject)
							</a>
						</td>
						<td headers="date">$item.Header.DateSent.toStringLocalFull()</td>
					</tr>
				#end		
			</table>
		#else
			<div class="chefPageviewTitle">
				No archived email yet...
			</div>
		#end	
	</div>	
</div>	
