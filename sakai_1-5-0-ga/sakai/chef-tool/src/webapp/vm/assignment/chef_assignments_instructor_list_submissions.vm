	##<!-- $Header: /cvs/sakai/chef-tool/src/webapp/vm/assignment/chef_assignments_instructor_list_submissions.vm,v 1.4 2004/12/07 15:20:27 zqian.umich.edu Exp $ -->
	<div class="chefPortletContainer">
		#if($menu)#toolbar($menu)#end
		<div class="chef2ndToolbarWrap">
			<table class="chef2ndToolbar" cellspacing="0" summary="this is for second toolbar, containing dropdown view list, search area and paging" >
				<tr class="first">
					<td class="left">
						<form name="viewForm" class="toolbarForm" method="post" action="#toolForm("AssignmentAction")">
							<input type="hidden" name="eventSubmit_doView" value="view" />
							View:
							<select name="view" size="1" tabindex="3" onchange="blur();document.viewForm.submit();">
								#foreach ($view in ["List of Submissions", "List of Assignments", "List of Assignments by student", "Grade Report", "Student View"])
									#if ($selectedView.equals($view))
										<option value="$view" selected="selected" >$view</option>
									#else
										<option value="$view" >$view</option>
									#end
								#end
							</select>
						</form>
					</td>
					<td class="right">
						#*removed for now
						<form name="searchForm" class="toolbarForm" action="#toolForm("AssignmentAction")" method="post">
							<input size="20" value="$searchString" name="$form_search" id="$form_search" type="text" class="searchField" style="background-color:#fff;width:10em;color:#000" />
							<input type="submit" name="eventSubmit_doSearch" value="Search" accesskey="a" />
							#if (($!searchString) && (!$searchString.equals("")))
								<input type="submit" name="eventSubmit_doSearch_clear" value="Clear Search" accesskey="a" />
							#end
						</form>
						*#
						&nbsp;
					</td>
				</tr>
				#if (($prev_page_exists) || ($next_page_exists))
					<tr class="second">
						<td class="left">
							&nbsp; 
						</td>
						<td class="right">
							<form name="pagingForm" class="toolbarForm" method="post">
								#if ($paged)
									#if ($totalPageNumber > 1)
										Page:
										#if ($prev_page_exists)
											<a href="#toolLink("AssignmentAction" "doList_prev")" title="View Previous Page"><img src="#imageLink("chef/back.gif")" alt="View Previous Page" border="0" width="4" height="9" align="baseline" /></a>
										#else
											<img src="#imageLink("chef/s.gif")" alt="" border="0" width="4" height="9" align="baseline" />
										#end
										#foreach ($pageNumber in [1..$totalPageNumber])
											#if ($pageNumber == $current_page)
												<span class="chefAlert">$pageNumber</span>
											#else
												<a href="#toolLink("AssignmentAction" "doView_page")&$formPageNumber=$pageNumber" title="View page $pageNumber of $totalPageNumber">$pageNumber</a>
											#end
										#end
										#if ($next_page_exists)
											<a href="#toolLink("AssignmentAction" "doList_next")" title="View Next Page"><img src="#imageLink("chef/forward.gif")" alt="View Next Page" border="0" width="4" height="9" align="baseline" /></a>
										#else
											<img src="#imageLink("chef/s.gif")" alt="" border="0" width="4" height="9" align="baseline" />
										#end
										|
										<a href="#toolLink("AssignmentAction" "doToggle_paging")" title="Show All">
											Show All
										</a>
									#end
								#else
									<a href="#toolLink("AssignmentAction" "doToggle_paging")" title="Show Paging">
										Pages</a>
									| Show All
								#end
							</form>
						</td>
					</tr>
				#end	
			</table>
		</div>
		<div class="chefPortletContent">
		#if ($alertMessage)<div class="chefAlertBox">Alert: $validator.escapeHtml($alertMessage)</div>#end
			<div class="chefPageviewTitle">
				Choose a student's name to view submitted assignment and begin grading.			
			</div>
			<form name= "listSubmissionsForm" action="#toolForm("AssignmentAction")" method="post">
				<input type="hidden" name="assignmentId" value="$assignment.Reference" />
				#if ($assignment_expand_flag)
					<table class="chefSectionContent" cellpadding="0" cellspacing="0" summary="The assignment infos">
						<tr> 
							<th>
								<a href="#" onclick="location='#toolLink("AssignmentAction" "doCollapse_grade_assignment")'; return false;" title="Hide assignment info">
									<img src="#imageLink("chef/collapse.gif")" alt="Open, click to close" border="0" width="15" height="15" align="top" /></a>
									  $validator.escapeHtml($assignment.title)
							</th>
						</tr>
						<tr> 
							<td class="content">
								<table class="chefItemDetail" border="0">
									<tr>
									#*
										<td class="chefLabel">
												Section:
										</td>
										<td>
											$assignment.Section
										</td>
										*#
										<td class="chefLabel">
											Created by:
										</td>
										<td>
											$userDirectoryService.getUser($assignment.getCreator()).DisplayName ($assignment.TimeCreated.toStringLocalFull())
										</td>
									</tr>
									<tr>
										<td class="chefLabel">
											Modified:
										</td>
										<td>
											$assignment.TimeLastModified.toStringLocalFull()
										</td>
									</tr>

									<tr> 
										<td class="chefLabel">
											Open:
										</td>
										<td>
											$assignment.OpenTime.toStringLocalFull()
										</td>
									</tr>
									<tr> 
										<td class="chefLabel">
												Due:
										</td>
										<td>
											$assignment.DueTime.toStringLocalFull()
										</td>
									</tr>
									#set ($closeDate = $assignment.getCloseTime())
									#if ($!closeDate)
										<tr> 
											<td class="chefLabel">
												Accept submissions until:
											</td>
											<td>
												$assignment.CloseTime.toStringLocalFull()
											</td>
										</tr>
									#end
									<tr valign="top"> 
										<td align="right" nowrap="nowrap" class="chefLabel">
											Student submissions:
										</td>
										<td nowrap="nowrap">
											$submissionTypeTable.get($assignment.getContent().getTypeOfSubmission())
										</td>
									</tr>
									<tr valign="top"> 
										<td class="chefLabel">
											Grade scale:
										</td>
										<td nowrap="nowrap">
											#set ($gradeScale = $assignment.getContent().getTypeOfGradeString($assignment.getContent().getTypeOfGrade()))
											$gradeScale
											#if ($gradeScale == "Points")
												(max $assignment.getContent().getMaxGradePointDisplay())
											#end
										</td>
									</tr>
									<tr> 
										<td class="chefLabel">
											Honor pledge:
										</td>
										<td> 
											#if ($assignment.getContent().HonorPledge == 1)
												No
											#else
												Yes
											#end
										</td>
									</tr>
									<tr>
										<td colspan="2" class="chefLabel">
											Assignment instructions:
										</td>
									</tr>
									<tr>
										<td colspan="2">
											<div class="chefSectionMessage">					
												#if ($assignment.getContent().getInstructions().length()==0)
													<p><i>&lt;none&gt;</i></p>
												#else
													<p><span class="chefPre">$validator.escapeHtmlFormattedText($assignment.getContent().getInstructions())</span></p>
												#end
											</div>
											<fieldset class="chefAttachmentsF">
												<legend class="chefAttachmentsL">	
													Additional resources:
												</legend> 
												#set ($size = 0)
												#set ($attachments = $assignment.getContent().Attachments)
												#set ($props = false)
												#foreach ($attachment in $attachments) 
													#set ($props = $attachment.Properties) 
													#if ($!props)
														#set ($size = $size + 1)
													#end
												#end
												#if ($size == 0)
													No attachments ...
												#else
													<ul class="chefAttachmentList">
														#foreach ($attachment in $attachments) 
															#set ($props = false)
															#set ($props = $attachment.Properties) 
															#if ($!props)
																<li>
																	#if ($props.getBooleanProperty($props.NamePropIsCollection))
																		<img src = "#imageLink($contentTypeImageService.getContentTypeImage("folder"))" border="0" alt="folder attachment" />
																	#else
																		<img src = "#imageLink($contentTypeImageService.getContentTypeImage($props.getProperty($props.NamePropContentType)))" border="0" alt="File attachment" />
																	#end
																	<a href="$attachment.Url" target="_blank">$validator.escapeHtml($props.getPropertyFormatted($props.NamePropDisplayName))</a>						
																	#if (!$props.getBooleanProperty($props.NamePropIsCollection))
																		($props.getPropertyFormatted($props.NamePropContentLength))
																	#end
																</li>
															#end
														#end
													</ul>
												#end	
											</fieldset>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				#else
					<table cellpadding="0" cellspacing="0" class="chefSectionContent" summary="Assignment details">
						<tr> 
							<th colspan="3">
								<a href="#" onclick="location='#toolLink("AssignmentAction" "doExpand_grade_assignment")'; return false;" title="Expand grade assignment">	
									<img src="#imageLink("chef/expand.gif")" alt="Open, click to close" border="0" width="15" height="15" align="top" alt="Expand assignment infos" /></a>
							<span class="PageviewSection">$assignment.title</span>
							</th>
						</tr>
					</table>
				#end
				#if ($submission_expand_flag)
					## show all submissions
					<table cellpadding="0" cellspacing="0" class="chefSectionContent" summary="The assignment submissions">
						<tr> 
							<th>
								<a href="#" onclick="location='#toolLink("AssignmentAction" "doCollapse_grade_submission")'; return false;" title="Hide submission list">
									<img src="#imageLink("chef/collapse.gif")"  border="0" width="15" height="15" align="top" alt="Hide submission list" /></a>
								Student Submissions
							</th>
							<th style="text-align:right">Status: 
								#set ($totalSubmission = $service.getSubmissions($assignment))
								#set ($gradedNumber = 0)
								#set ($ungradedNumber = 0)
								#foreach ($s in $totalSubmission)
									#if ($s.Submitted)
										#if ($s.Graded)
											#set ($gradedNumber = $gradedNumber + 1)
										#else
											#set ($ungradedNumber = $ungradedNumber + 1)
										#end
									#end
								#end
								$gradedNumber Graded / $ungradedNumber ungraded
							</th>
						</tr>
						<tr> 
							<td class="content" colspan="2">
								<div class="chefPageviewTitle">
									Select a student name to view the student's submitted assignments and start grading.<!-- Title of this page.... -->			
								</div>
								#if ($!submissions && ($submissions.size() > 0))
									<table class="chefFlatListViewTable" cellpadding="0" cellspacing="0">
										<tr> 
											<th id="attachment">
												&nbsp;
											</th>
											<th id="studentname">
												<a href="#" onclick="location='#toolLink("AssignmentAction" "doSort_submission")&criteria=lastname'; return false;" title="Sort by Last Name">
													Student
													#if ($sortedBy.equals("lastname")) 
														#if ($sortedAsc.equals("true")) 
															<img id="sortascendinglastname" src = "#imageLink("chef/sortascending.gif")" border="0" alt="Sort ascending" /> 
														#else 
															<img id="sortdescendinglastname" src = "#imageLink("chef/sortdescending.gif")" border="0" alt="Sort descending" /> 
														#end 
													#end 
												</a>
											</th>
											<th id="submitted">
												<a href="#" onclick="location='#toolLink("AssignmentAction" "doSort_submission")&criteria=submit_time'; return false;" title="Sort by Submission Time">
													Submitted
													#if ($sortedBy.equals("submit_time")) 
														#if ($sortedAsc.equals("true")) 
															<img id="sort_ascending_submittime" src = "#imageLink("chef/sortascending.gif")" border="0" alt="Sort ascending" /> 
														#else 
															<img id="sort_descending_submit_time" src = "#imageLink("chef/sortdescending.gif")" border="0" alt="Sort descending" /> 
														#end 
													#end 
												</a>
											</th>
											<th id="status">
												<a href="#" onclick="location='#toolLink("AssignmentAction" "doSort_submission")&criteria=status'; return false;" title="Sort by Status">
													Status
													#if ($sortedBy.equals("status")) 
														#if ($sortedAsc.equals("true")) 
															<img id="sort_ascending_status" src = "#imageLink("chef/sortascending.gif")" border="0" alt="Sort ascending" /> 
														#else 
															<img id="sort_descending_status" src = "#imageLink("chef/sortdescending.gif")" border="0" alt="Sort descending" /> 
														#end 
													#end 
												</a>
											</th>
											<th id="grade">
												<a href="#" onclick="location='#toolLink("AssignmentAction" "doSort_submission")&criteria=submission_grade'; return false;" title="Sort by Grade">
													Grade
													#if ($sortedBy.equals("submission_grade")) 
														#if ($sortedAsc.equals("true")) 
															<img id="sort_ascending_grade" src = "#imageLink("chef/sortascending.gif")" border="0" alt="Sort ascending" /> 
														#else 
															<img id="sort_descending_grade" src = "#imageLink("chef/sortdescending.gif")" border="0" alt="Sort descending" /> 
														#end 
													#end 
												</a>
											</th>
											<th id="gradereleased">
												<a href="#" onclick="location='#toolLink("AssignmentAction" "doSort_submission")&criteria=released'; return false;" title="Sort by Released">
													Released
													#if ($sortedBy.equals("released")) 
														#if ($sortedAsc.equals("true")) 
															<img id="sort_ascending_released" src = "#imageLink("chef/sortascending.gif")" border="0" alt="Sort ascending" /> 
														#else 
															<img id="sort_descending_released" src = "#imageLink("chef/sortdescending.gif")" border="0" alt="Sort descending" /> 
														#end 
													#end 
												</a>
											</th>
										</tr>
										#foreach ($submission in $submissions) 
											#set ($returnedTime = $submission.getTimeReturned())
											#set ($submitTime = $submission.getTimeSubmitted())
											#if ($submission.Submitted)
												<tr> 
													<td headers="attachment">
														#set ($attachments = $!submission.SubmittedAttachments)
														#set ($size = 0)
														#set ($props = false)
														#if (!$!attachments.isEmpty())
															#set ($attachment = $attachments.next())
															#set ($props = $attachment.Properties) 
															#if ($!props)
																#set ($size = $size + 1)
															#end
														#end 
														#if ($size > 0)
															<img src="#imageLink("chef/attachments.gif")" border="0" alt="Attachment" width="15" height="15" />
														#end
													</td>
													<td headers="studentname">
														#if ($!submission)
															<a href="#toolLink("AssignmentAction" "doGrade_submission")&assignmentId=$assignment.Reference&submissionId=$submission.Reference" title="Grade submission">
																#set ($submitters = $submission.submitters)
																#set ($names = "")
																#set ($count = 1)
																#foreach ($submitter in $submitters)
																	#if ($count > 1)
																		#set ($names = $names.concat(", "))
																	#end
																	#set ($names = $names.concat($submitter.LastName).concat(", ").concat($submitter.FirstName))
																	#set ($count = $count + 1)
																#end
																$names
															</a>
														#end
													</td>
													<td headers="submitted">
														#if ($!submission)
															$submitTime.toStringLocalFull()
															#if ($submitTime.after($assignment.DueTime))
																<span class="chefAlert">- late</span>
															#end
														#else
															No Submission
														#end
													</td>
													<td headers="status">
														#if ($submission.Returned)
															#if ($!returnedTime && $returnedTime.before($submitTime))
																Re-submitted 
															#else
																Returned
															#end
														#elseif ($submission.getGraded())
															#if ($submission.getGradeReleased())
																Released
															#else
																Graded
															#end
														#else
															Ungraded
														#end
													</td>
													<td headers="grade">
														$submission.getGradeDisplay()
													</td>
													<td headers="gradereleased">
														#if ($submission.getGradeReleased())
															<img src="#imageLink("chef/checkon.gif")" alt="Open, click to close" border="0" width="15" height="15" align="top" />
														#else
															<img src="#imageLink("chef/checkoff.gif")" alt="Open, click to close" border="0" width="15" height="15" align="top" />
														#end
													</td>
												</tr>
											#end
										#end
									#end
								</table>
							</td>
						</tr>
					</table>
				#else
					##hide all submissions
					<table cellpadding="0" cellspacing="0" class="chefSectionContent" summary="The assignment submissions"> 
						<tr> 
							<th>
								<a href="#" onclick="location='#toolLink("AssignmentAction" "doExpand_grade_submission")'; return false;" title="Expand grade submission">
									<img src="#imageLink("chef/expand.gif")" alt="Open, click to close" border="0" width="15" height="15" align="top" /></a>
								Student Submissions
							</th>
							<th colspan="2" style="text-align:right">Status: 
								#set ($totalSubmission = $service.getSubmissions($assignment))
								#set ($gradedNumber = 0)
								#set ($ungradedNumber = 0)
								#foreach ($s in $totalSubmission)
									#if ($s.Submitted)
										#if ($s.Graded)
											## grade and if returned, not resubmission yet
											#set ($gradedNumber = $gradedNumber + 1)
										#else
											#set ($ungradedNumber = $ungradedNumber + 1)
										#end
									#end
								#end
								$gradedNumber Graded / $ungradedNumber ungraded
							</th>
						</tr>				
					</table>
				#end
			</form>
			#if (($prev_page_exists) || ($next_page_exists))
				<table class="chef2ndToolbar" cellspacing="0" summary="Paging" style="margin-top:30px">
					<tr class="second">
						<td class="left">
							&nbsp; 
						</td>
						<td class="right">
							<form name="pagingForm" class="toolbarForm" method="post">
								#if ($paged)
									#if ($totalPageNumber > 1)
										Page:
										#if ($prev_page_exists)
											<a href="#toolLink("AssignmentAction" "doList_prev")" title="View Previous Page"><img src="#imageLink("chef/back.gif")" alt="View Previous Page" border="0" width="4" height="9" align="baseline" /></a>
										#else
											<img src="#imageLink("chef/s.gif")" alt="" border="0" width="4" height="9" align="baseline" />
										#end
										#foreach ($pageNumber in [1..$totalPageNumber])
											#if ($pageNumber == $current_page)
												<span class="chefAlert">$pageNumber</span>
											#else
												<a href="#toolLink("AssignmentAction" "doView_page")&$formPageNumber=$pageNumber" title="View page $pageNumber of $totalPageNumber">$pageNumber</a>
											#end
										#end
										#if ($next_page_exists)
											<a href="#toolLink("AssignmentAction" "doList_next")" title="View Next Page"><img src="#imageLink("chef/forward.gif")" alt="View Next Page" border="0" width="4" height="9" align="baseline" /></a>
										#else
											<img src="#imageLink("chef/s.gif")" alt="" border="0" width="4" height="9" align="baseline" />
										#end
										|
										<a href="#toolLink("AssignmentAction" "doToggle_paging")" title="Show All">
											Show All
										</a>
									#end
								#else
									<a href="#toolLink("AssignmentAction" "doToggle_paging")" title="Show Paging">
										Pages</a>
									| Show All
								#end
							</form>
						</td>
					</tr>
				</table>
			#end	
		</div>
	</div>
